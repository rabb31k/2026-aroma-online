<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2026 台灣精油芳療年會 | 光影流芳 五行共生</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Noto+Serif+TC:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Noto Sans TC', 'sans-serif'],
              serif: ['Noto Serif TC', 'serif'],
            },
            animation: {
              'fade-in-up': 'fadeInUp 0.5s ease-out forwards',
              'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            },
            keyframes: {
              fadeInUp: {
                '0%': { opacity: '0', transform: 'translateY(20px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' },
              }
            }
          }
        }
      }
    </script>

    <!-- External Libs -->
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- html2canvas -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <style>
      html { scroll-behavior: smooth; }
      ::-webkit-scrollbar { width: 8px; }
      ::-webkit-scrollbar-track { background: #1a1a1a; }
      ::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
      ::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
      
      .animate-fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
      
      @keyframes blob {
        0% { transform: translate(0px, 0px) scale(1); }
        33% { transform: translate(30px, -50px) scale(1.1); }
        66% { transform: translate(-20px, 20px) scale(0.9); }
        100% { transform: translate(0px, 0px) scale(1); }
      }
      .animate-blob { animation: blob 7s infinite; }
      .animation-delay-2000 { animation-delay: 2s; }
      
      select {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.1/",
    "react/": "https://aistudiocdn.com/react@^19.2.1/",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.556.0",
    "vite": "https://aistudiocdn.com/vite@^7.2.7",
    "@vitejs/plugin-react": "https://aistudiocdn.com/@vitejs/plugin-react@^5.1.2"
  }
}
</script>
</head>
<body class="bg-stone-50 min-h-screen text-stone-800 selection:bg-amber-200 selection:text-amber-900">

    <!-- Navbar -->
    <nav id="navbar" class="fixed top-0 left-0 w-full z-50 transition-all duration-300 bg-transparent py-6">
      <div class="container mx-auto px-6 md:px-12 lg:px-20 flex justify-between items-center text-white">
        <!-- Logo -->
        <div class="flex items-center space-x-2 cursor-pointer" onclick="document.getElementById('hero').scrollIntoView({behavior: 'smooth'})">
          <div class="bg-gradient-to-tr from-yellow-400 to-amber-600 p-2 rounded-full">
            <i data-lucide="flower-2" class="w-6 h-6 text-white"></i>
          </div>
          <div class="flex flex-col">
             <span class="font-serif text-lg font-bold leading-none tracking-widest">AROMATHERAPY</span>
             <span class="text-[10px] tracking-wider opacity-80">2026 CONFERENCE</span>
          </div>
        </div>

        <!-- Desktop Menu -->
        <div class="hidden md:flex items-center space-x-8">
          <button onclick="document.getElementById('calculator').scrollIntoView({behavior: 'smooth'})" class="hover:text-amber-400 transition-colors text-sm tracking-widest">
            生命靈數計算
          </button>
          <button onclick="document.getElementById('exhibition').scrollIntoView({behavior: 'smooth'})" class="hover:text-amber-400 transition-colors text-sm tracking-widest">
            線上展覽
          </button>
        </div>

        <!-- Mobile Toggle -->
        <div class="md:hidden">
          <button onclick="toggleMobileMenu()" id="mobile-menu-btn">
            <i data-lucide="menu"></i>
          </button>
        </div>
      </div>

      <!-- Mobile Menu -->
      <div id="mobile-menu" class="hidden md:hidden absolute top-full left-0 w-full bg-stone-900 border-t border-stone-800 p-6 flex flex-col space-y-4 shadow-xl">
          <button onclick="document.getElementById('calculator').scrollIntoView({behavior: 'smooth'}); toggleMobileMenu()" class="text-left text-white hover:text-amber-400 py-2">
            生命靈數計算
          </button>
          <button onclick="document.getElementById('exhibition').scrollIntoView({behavior: 'smooth'}); toggleMobileMenu()" class="text-left text-white hover:text-amber-400 py-2">
            線上展覽
          </button>
      </div>
    </nav>

    <main>
        <!-- Hero Section -->
        <section id="hero" class="relative w-full min-h-screen flex items-center justify-center overflow-hidden bg-stone-900">
            <div class="absolute inset-0 z-0">
                <img src="https://picsum.photos/id/132/1920/1080" alt="Background" class="w-full h-full object-cover opacity-60" />
                <div class="absolute inset-0 bg-gradient-to-br from-stone-900 via-amber-900/40 to-emerald-900/60 mix-blend-overlay"></div>
                <div class="absolute inset-0 bg-gradient-to-b from-transparent via-stone-900/20 to-stone-900"></div>
                <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-amber-500/20 rounded-full blur-[100px] animate-pulse-slow"></div>
                <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-emerald-500/20 rounded-full blur-[100px] animate-pulse-slow animation-delay-2000"></div>
            </div>

            <div class="relative z-10 container mx-auto px-6 md:px-12 lg:px-20 grid md:grid-cols-2 gap-12 items-center h-full pt-20">
                <div class="space-y-8">
                    <div class="flex items-center space-x-3 bg-white/10 backdrop-blur-md w-fit px-4 py-2 rounded-full border border-white/10">
                        <div class="flex -space-x-2">
                            <div class="w-8 h-8 rounded-full bg-emerald-400 flex items-center justify-center border-2 border-stone-800"><i data-lucide="user" class="w-4 h-4 text-white"></i></div>
                            <div class="w-8 h-8 rounded-full bg-amber-400 flex items-center justify-center border-2 border-stone-800"><i data-lucide="users" class="w-4 h-4 text-white"></i></div>
                            <div class="w-8 h-8 rounded-full bg-blue-400 flex items-center justify-center border-2 border-stone-800"><i data-lucide="user-plus" class="w-4 h-4 text-white"></i></div>
                        </div>
                        <span class="text-white text-sm font-medium">已有 <span class="text-amber-400 font-bold">2,680</span> 位芳療師參與體驗</span>
                    </div>

                    <div class="space-y-4">
                        <h1 class="text-5xl sm:text-6xl md:text-7xl lg:text-8xl font-serif text-white font-bold leading-tight drop-shadow-lg">
                            <span class="block mb-2 text-transparent bg-clip-text bg-gradient-to-r from-white to-amber-100">光影流芳</span>
                            <span class="block text-transparent bg-clip-text bg-gradient-to-r from-amber-200 to-emerald-200">五行共生</span>
                        </h1>
                        <p class="text-lg sm:text-xl md:text-2xl text-amber-100/80 tracking-widest font-light">2026 台灣精油芳療年會</p>
                    </div>

                    <button onclick="document.getElementById('calculator').scrollIntoView({behavior: 'smooth'})" class="group bg-gradient-to-r from-amber-600 to-amber-700 hover:from-amber-500 hover:to-amber-600 text-white px-8 py-4 rounded-full text-lg font-bold tracking-wider shadow-lg shadow-amber-900/50 transition-all duration-300 flex items-center gap-2 transform hover:-translate-y-1">
                        開始探索你的五行能量
                        <i data-lucide="chevron-down" class="w-5 h-5 group-hover:translate-y-1 transition-transform"></i>
                    </button>
                </div>

                <div class="hidden md:block">
                    <div class="bg-white/10 backdrop-blur-lg border border-white/20 p-8 rounded-3xl text-white/90 shadow-2xl max-w-md ml-auto transform rotate-1 hover:rotate-0 transition-transform duration-500">
                        <p class="text-lg leading-relaxed font-light">
                            每個人都有專屬的五行能量密碼，透過生命靈數，找到你與精油的共振頻率。在光影交織中，感受<span class="text-emerald-300 font-medium">木的生發</span>、<span class="text-red-300 font-medium">火的熱情</span>、<span class="text-yellow-300 font-medium">土的穩定</span>、<span class="text-gray-300 font-medium">金的收斂</span>、<span class="text-blue-300 font-medium">水的流動</span>。
                        </p>
                    </div>
                </div>
            </div>

            <!-- Scroll Indicator: Fixed alignment -->
            <div class="absolute bottom-8 left-0 w-full flex flex-col items-center animate-bounce text-white/50 z-20 pointer-events-none">
                <span class="text-xs tracking-widest mb-2">向下探索</span>
                <i data-lucide="chevron-down" class="w-6 h-6"></i>
            </div>
        </section>

        <!-- Calculator Section -->
        <section id="calculator" class="py-24 bg-stone-50 overflow-hidden relative">
            <div class="absolute top-0 right-0 w-64 h-64 bg-emerald-100/50 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"></div>
            <div class="absolute bottom-0 left-0 w-96 h-96 bg-amber-100/50 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2"></div>

            <div class="container mx-auto px-6 md:px-12 lg:px-20 relative z-10">
                <div class="flex flex-col items-center mb-16">
                    <h2 class="text-6xl md:text-9xl font-serif text-stone-800 opacity-10 absolute top-[-40px] select-none">01</h2>
                    <h2 class="text-4xl md:text-5xl font-serif font-bold text-stone-800 mb-4 relative">生命靈數計算</h2>
                    <div class="w-24 h-1 bg-gradient-to-r from-emerald-500 to-amber-500"></div>
                </div>

                <div class="grid md:grid-cols-2 gap-12 lg:gap-24 items-start max-w-6xl mx-auto">
                    <!-- Input Area -->
                    <div class="bg-white p-8 md:p-12 rounded-3xl shadow-xl shadow-stone-200/50 border border-stone-100 sticky top-24">
                        <h3 class="text-xl text-stone-600 mb-8 font-medium">請選擇您的西元出生日期</h3>
                        
                        <div class="space-y-6">
                            <div class="space-y-2">
                                <label class="text-sm text-stone-500 font-medium tracking-wide">年份</label>
                                <div class="relative">
                                    <select id="calc-year" onchange="checkInputs()" class="w-full bg-stone-50 border border-stone-200 rounded-xl px-4 py-3 appearance-none focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-stone-700">
                                        <option value="" disabled selected>選擇年份</option>
                                    </select>
                                    <i data-lucide="chevron-down" class="absolute right-4 top-1/2 -translate-y-1/2 text-stone-400 w-5 h-5 pointer-events-none"></i>
                                </div>
                            </div>

                            <div class="space-y-2">
                                <label class="text-sm text-stone-500 font-medium tracking-wide">月份</label>
                                <div class="relative">
                                    <select id="calc-month" onchange="checkInputs()" class="w-full bg-stone-50 border border-stone-200 rounded-xl px-4 py-3 appearance-none focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-stone-700">
                                        <option value="" disabled selected>選擇月份</option>
                                    </select>
                                    <i data-lucide="chevron-down" class="absolute right-4 top-1/2 -translate-y-1/2 text-stone-400 w-5 h-5 pointer-events-none"></i>
                                </div>
                            </div>

                            <div class="space-y-2">
                                <label class="text-sm text-stone-500 font-medium tracking-wide">日期</label>
                                <div class="relative">
                                    <select id="calc-day" onchange="checkInputs()" class="w-full bg-stone-50 border border-stone-200 rounded-xl px-4 py-3 appearance-none focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all text-stone-700">
                                        <option value="" disabled selected>選擇日期</option>
                                    </select>
                                    <i data-lucide="chevron-down" class="absolute right-4 top-1/2 -translate-y-1/2 text-stone-400 w-5 h-5 pointer-events-none"></i>
                                </div>
                            </div>

                            <button id="calc-btn" onclick="calculateLifePath()" disabled class="w-full bg-emerald-700 hover:bg-emerald-800 disabled:bg-stone-300 disabled:cursor-not-allowed text-white font-bold py-4 rounded-xl transition-all duration-300 shadow-lg shadow-emerald-900/20 mt-4">
                                計算我的五行屬性
                            </button>
                        </div>
                    </div>

                    <!-- Result Area -->
                    <div class="flex flex-col items-center justify-center min-h-[400px] w-full">
                        <!-- Initial State: 5 Elements Display -->
                        <div id="result-initial" class="flex flex-col gap-6 items-center justify-center h-full">
                            <div class="grid grid-cols-5 gap-3 md:gap-6 w-full max-w-lg">
                                <div class="flex flex-col items-center gap-2">
                                    <div class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-emerald-600 flex items-center justify-center shadow-lg border-2 border-white"><i data-lucide="leaf" class="w-6 h-6 md:w-8 md:h-8 text-white"></i></div>
                                    <span class="text-emerald-800 font-bold text-sm md:text-base">木</span>
                                </div>
                                <div class="flex flex-col items-center gap-2">
                                    <div class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-red-600 flex items-center justify-center shadow-lg border-2 border-white"><i data-lucide="flame" class="w-6 h-6 md:w-8 md:h-8 text-white"></i></div>
                                    <span class="text-red-800 font-bold text-sm md:text-base">火</span>
                                </div>
                                <div class="flex flex-col items-center gap-2">
                                    <div class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-yellow-700 flex items-center justify-center shadow-lg border-2 border-white"><i data-lucide="mountain" class="w-6 h-6 md:w-8 md:h-8 text-white"></i></div>
                                    <span class="text-yellow-800 font-bold text-sm md:text-base">土</span>
                                </div>
                                <div class="flex flex-col items-center gap-2">
                                    <div class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-yellow-400 flex items-center justify-center shadow-lg border-2 border-white"><i data-lucide="diamond" class="w-6 h-6 md:w-8 md:h-8 text-yellow-900"></i></div>
                                    <span class="text-yellow-600 font-bold text-sm md:text-base">金</span>
                                </div>
                                <div class="flex flex-col items-center gap-2">
                                    <div class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-blue-600 flex items-center justify-center shadow-lg border-2 border-white"><i data-lucide="droplet" class="w-6 h-6 md:w-8 md:h-8 text-white"></i></div>
                                    <span class="text-blue-800 font-bold text-sm md:text-base">水</span>
                                </div>
                            </div>
                            <p class="text-xl text-stone-500 font-serif mt-4 text-center">選擇你的生日，開啟專屬五行之旅</p>
                        </div>

                        <!-- Result Card Container (Hidden initially) -->
                        <div id="result-container" class="w-full flex flex-col items-center hidden animate-fade-in-up">
                            
                            <!-- Card to Capture (We will display this, and also screenshot it) -->
                            <!-- Added id="capture-card" -->
                            <div id="capture-card" class="relative w-full max-w-sm text-white rounded-[2rem] shadow-2xl overflow-hidden bg-stone-300 transition-all" style="min-height: 600px;">
                                <!-- Header -->
                                <div class="pt-8 pb-4 text-center px-6">
                                    <h2 class="text-lg font-medium opacity-90 tracking-widest mb-1">2026 台灣精油芳療年會</h2>
                                    <h1 class="text-2xl font-serif font-bold tracking-wider">光影流芳 • 五行共生</h1>
                                </div>
                                <div class="w-full h-px bg-white/20 my-2"></div>
                                
                                <!-- Content -->
                                <div class="p-8 flex flex-col items-center text-center content-box">
                                    <div class="relative mb-6">
                                        <div class="w-24 h-24 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center border border-white/30" id="res-icon-container">
                                            <!-- Icon here -->
                                        </div>
                                        <div id="res-number" class="absolute -bottom-2 -right-2 bg-white text-stone-900 w-10 h-10 rounded-full flex items-center justify-center font-bold text-xl shadow-lg border-2 border-white">
                                            <!-- Number here -->
                                        </div>
                                    </div>

                                    <div class="space-y-1 mb-6">
                                        <p class="text-lg opacity-90 font-medium">五行屬性：<span id="res-element"></span></p>
                                        <p class="text-lg opacity-90 font-medium">對應體質：<span id="res-constitution"></span></p>
                                    </div>

                                    <h3 id="res-title" class="text-4xl font-serif font-bold mb-4"></h3>

                                    <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20 w-full">
                                        <p id="res-desc" class="text-lg leading-relaxed font-light tracking-wide"></p>
                                    </div>
                                </div>
                                <div class="absolute bottom-0 left-0 w-full h-32 bg-gradient-to-t from-black/20 to-transparent pointer-events-none"></div>
                            </div>

                            <!-- Generated Image Display Area (Initially Hidden) -->
                            <div id="generated-image-area" class="hidden flex-col items-center mt-0 w-full max-w-sm">
                                <img id="final-image" src="" alt="Result" class="rounded-[2rem] shadow-2xl w-full" />
                                <p class="mt-4 text-sm text-stone-500 animate-pulse text-center">
                                    <span class="block md:hidden">長按上方圖片即可儲存至相簿</span>
                                    <span class="hidden md:block">圖片已自動下載</span>
                                </p>
                            </div>

                            <!-- Buttons -->
                            <div class="flex gap-4 mt-8">
                                <button id="btn-save" onclick="generateAndSave()" class="flex items-center gap-2 bg-stone-800 hover:bg-stone-700 text-white px-6 py-3 rounded-full transition-all shadow-lg">
                                    <i data-lucide="download" class="w-4 h-4"></i> 保存/下載結果
                                </button>
                                
                                <button onclick="resetCalculator()" class="flex items-center gap-2 bg-white border border-stone-200 hover:bg-stone-50 text-stone-600 px-6 py-3 rounded-full transition-all shadow-md">
                                    <i data-lucide="refresh-cw" class="w-4 h-4"></i> 重新計算
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Exhibition Section -->
        <section id="exhibition" class="py-24 bg-white">
            <div class="container mx-auto px-6 md:px-12 lg:px-20">
                <div class="text-center mb-20 space-y-4">
                    <span class="bg-amber-100 text-amber-800 px-4 py-1 rounded-full text-sm font-bold tracking-wider">線上虛擬展覽</span>
                    <h2 class="text-4xl md:text-6xl font-serif font-bold text-stone-800">
                        沉浸式五行體驗<br/>
                        <span class="text-stone-600 italic text-3xl md:text-5xl mt-2 block">探索光影流芳的奧秘</span>
                    </h2>
                    <p class="text-stone-500 max-w-2xl mx-auto pt-4">
                        透過虛擬實境技術，在家也能身歷其境參與年會展覽。每個展區都對應不同的五行能量，等待您的探索。
                    </p>
                </div>
                <div id="exhibition-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- JS Injected -->
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer id="footer" class="bg-stone-900 text-stone-400 py-16">
        <div class="container mx-auto px-6 md:px-12 lg:px-20">
            <div class="grid md:grid-cols-4 gap-12 mb-12 border-b border-stone-800 pb-12">
                <div class="col-span-1 md:col-span-2 space-y-4">
                    <h3 class="text-white text-2xl font-serif">2026 台灣精油芳療年會</h3>
                    <p class="text-sm leading-relaxed max-w-md">致力於推廣正統芳香療法，結合東方五行哲學與西方科學實證，為現代人尋找身心平衡的自然處方。</p>
                </div>
                <div class="space-y-4">
                    <h4 class="text-white font-bold tracking-wider text-sm uppercase">快速連結</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="hover:text-amber-500 transition-colors">大會議程</a></li>
                        <li><a href="#" class="hover:text-amber-500 transition-colors">講師陣容</a></li>
                        <li><a href="#" class="hover:text-amber-500 transition-colors">購票資訊</a></li>
                        <li><a href="#" class="hover:text-amber-500 transition-colors">常見問題</a></li>
                    </ul>
                </div>
                <div class="space-y-4">
                    <h4 class="text-white font-bold tracking-wider text-sm uppercase">聯絡我們</h4>
                    <div class="flex space-x-4">
                        <a href="#" class="w-10 h-10 rounded-full bg-stone-800 flex items-center justify-center hover:bg-amber-600 hover:text-white transition-all"><i data-lucide="facebook" class="w-5 h-5"></i></a>
                        <a href="#" class="w-10 h-10 rounded-full bg-stone-800 flex items-center justify-center hover:bg-amber-600 hover:text-white transition-all"><i data-lucide="instagram" class="w-5 h-5"></i></a>
                        <a href="#" class="w-10 h-10 rounded-full bg-stone-800 flex items-center justify-center hover:bg-amber-600 hover:text-white transition-all"><i data-lucide="youtube" class="w-5 h-5"></i></a>
                    </div>
                    <div class="flex items-center gap-2 text-sm mt-4">
                        <i data-lucide="mail" class="w-4 h-4"></i>
                        <span>contact@aroma2026.tw</span>
                    </div>
                </div>
            </div>
            <div class="flex flex-col md:flex-row justify-between items-center text-xs">
                <p>&copy; 2026 Taiwan Aromatherapy Conference. All Rights Reserved.</p>
                <div class="flex space-x-6 mt-4 md:mt-0">
                    <a href="#" class="hover:text-white">隱私權政策</a>
                    <a href="#" class="hover:text-white">服務條款</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- MAIN SCRIPT -->
    <script>
        // --- 1. Constants & Data ---
        const ELEMENT_MAPPING = {
            1: { element: "木", constitution: "氣鬱x血瘀", title: "開創者", description: "你是超級行動派，敢冒險、不服輸的開創先鋒。", colorClass: "bg-emerald-600", icon: "leaf" },
            2: { element: "水", constitution: "陽虛x特稟", title: "協調者", description: "你是細膩的傾聽者，擅長在人際中成為潤滑劑。", colorClass: "bg-blue-600", icon: "droplet" },
            3: { element: "火", constitution: "陰虛x濕熱", title: "協調者", description: "你用熱情點亮世界，擁有點燃氣氛的感染力。", colorClass: "bg-red-600", icon: "flame" },
            4: { element: "土", constitution: "氣虛x痰濕", title: "穩固者", description: "你是注重細節、務實可靠，能把理想落地的人。", colorClass: "bg-yellow-700", icon: "mountain" },
            5: { element: "火", constitution: "陰虛x濕熱", title: "探索者", description: "你對新鮮事物充滿好奇，勇於打破框架前行。", colorClass: "bg-red-600", icon: "flame" },
            6: { element: "土", constitution: "氣虛x痰濕", title: "照顧者", description: "你樂於照顧他人，是溫暖又包容的療癒存在。", colorClass: "bg-yellow-700", icon: "mountain" },
            7: { element: "金", constitution: "氣虛x特稟", title: "思考者", description: "你善於冷靜分析與探索真理，是天生的洞察者。", colorClass: "bg-yellow-400 text-yellow-900", icon: "diamond" },
            8: { element: "金", constitution: "氣虛x特稟", title: "實踐者", description: "你是統籌全局，化理想為現實的執行高手。", colorClass: "bg-yellow-400 text-yellow-900", icon: "diamond" },
            9: { element: "水", constitution: "陽虛x特稟", title: "奉獻者", description: "你有強烈的使命感，願為世界付出與療癒他人。", colorClass: "bg-blue-600", icon: "droplet" },
        };

        const EXHIBITION_DATA = [
            { title: "光影序章", subtitle: "了解五行哲學與芳療的連結", tag: "前導區域", color: "text-white", bgGradient: "from-stone-800 to-stone-600", imageUrl: "https://picsum.photos/id/10/800/600" },
            { title: "木 · 生發之力", subtitle: "包含：植物能量配對遊戲", tag: "木之展區", color: "text-emerald-100", bgGradient: "from-emerald-600 to-teal-500", imageUrl: "https://picsum.photos/id/28/800/600" },
            { title: "火 · 熱情之光", subtitle: "包含：香氣記憶挑戰", tag: "火之展區", color: "text-orange-100", bgGradient: "from-red-600 to-orange-500", imageUrl: "https://picsum.photos/id/312/800/600" },
            { title: "土 · 穩定之基", subtitle: "包含：調香比例實驗", tag: "土之展區", color: "text-yellow-100", bgGradient: "from-yellow-600 to-amber-500", imageUrl: "https://picsum.photos/id/106/800/600" },
            { title: "金 · 收斂之質", subtitle: "包含：精油分子探索", tag: "金之展區", color: "text-gray-100", bgGradient: "from-slate-500 to-gray-400", imageUrl: "https://picsum.photos/id/250/800/600" },
            { title: "水 · 流動之韻", subtitle: "包含：冥想引導體驗", tag: "水之展區", color: "text-blue-100", bgGradient: "from-blue-600 to-cyan-500", imageUrl: "https://picsum.photos/id/486/800/600" },
        ];

        // --- 2. Navbar & Mobile Menu ---
        const navbar = document.getElementById('navbar');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                navbar.classList.add('bg-stone-900/90', 'backdrop-blur-md', 'shadow-lg', 'py-3');
                navbar.classList.remove('bg-transparent', 'py-6');
            } else {
                navbar.classList.remove('bg-stone-900/90', 'backdrop-blur-md', 'shadow-lg', 'py-3');
                navbar.classList.add('bg-transparent', 'py-6');
            }
        });

        let isMobileMenuOpen = false;
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const iconContainer = document.getElementById('mobile-menu-btn');
            isMobileMenuOpen = !isMobileMenuOpen;
            if (isMobileMenuOpen) {
                menu.classList.remove('hidden');
                iconContainer.innerHTML = '<i data-lucide="x"></i>';
            } else {
                menu.classList.add('hidden');
                iconContainer.innerHTML = '<i data-lucide="menu"></i>';
            }
            lucide.createIcons();
        }

        // --- 3. Calculator Logic ---
        const yearSel = document.getElementById('calc-year');
        const monthSel = document.getElementById('calc-month');
        const daySel = document.getElementById('calc-day');
        const calcBtn = document.getElementById('calc-btn');

        // Populate Options
        for (let i = 2024; i >= 1944; i--) { yearSel.add(new Option(i, i)); }
        for (let i = 1; i <= 12; i++) { const v = String(i).padStart(2,'0'); monthSel.add(new Option(v, v)); }
        for (let i = 1; i <= 31; i++) { const v = String(i).padStart(2,'0'); daySel.add(new Option(v, v)); }

        function checkInputs() {
            calcBtn.disabled = !(yearSel.value && monthSel.value && daySel.value);
        }

        function calculateLifePath() {
            const y = yearSel.value, m = monthSel.value, d = daySel.value;
            if(!y || !m || !d) return;
            
            let sum = 0;
            const str = `${y}${m}${d}`;
            for (let char of str) sum += parseInt(char);
            
            while (sum > 9) {
                let temp = 0;
                String(sum).split('').forEach(n => temp += parseInt(n));
                sum = temp;
            }

            renderResult(sum);
        }

        function renderResult(num) {
            const data = ELEMENT_MAPPING[num];
            if (!data) return;

            // Hide initial grid, show result container
            document.getElementById('result-initial').classList.add('hidden');
            document.getElementById('result-container').classList.remove('hidden');
            document.getElementById('result-container').classList.add('flex');
            
            // Reset image state to "Show HTML Card"
            const card = document.getElementById('capture-card');
            card.classList.remove('hidden');
            
            document.getElementById('generated-image-area').classList.remove('flex');
            document.getElementById('generated-image-area').classList.add('hidden');
            document.getElementById('btn-save').classList.remove('hidden'); // Show save button

            // Fill Data
            // Remove previous color classes
            card.className = `relative w-full max-w-sm text-white rounded-[2rem] shadow-2xl overflow-hidden ${data.colorClass} transition-all`;
            
            document.getElementById('res-icon-container').innerHTML = `<i data-lucide="${data.icon}" class="w-12 h-12 ${data.colorClass.includes('text-yellow-900') ? 'text-yellow-900' : 'text-white'}"></i>`;
            document.getElementById('res-number').innerText = num;
            document.getElementById('res-element').innerText = data.element;
            document.getElementById('res-constitution').innerText = data.constitution;
            document.getElementById('res-title').innerText = data.title;
            document.getElementById('res-desc').innerText = data.description;

            // Re-render icons inside the new HTML
            lucide.createIcons();
        }

        function resetCalculator() {
            document.getElementById('result-container').classList.add('hidden');
            document.getElementById('result-container').classList.remove('flex');
            document.getElementById('result-initial').classList.remove('hidden');
            yearSel.value = ""; monthSel.value = ""; daySel.value = "";
            checkInputs();
        }

        // --- 4. Image Generation ---
        async function generateAndSave() {
            const btn = document.getElementById('btn-save');
            const originalText = btn.innerHTML;
            btn.innerHTML = "生成中...";
            btn.disabled = true;

            const originalCard = document.getElementById('capture-card');
            
            try {
                // 技術說明：
                // 不直接截圖畫面上的元素(會導致手機版跑版或截圖不全)。
                // 而是複製一個節點，放在螢幕外，設定固定寬度(500px)，確保所有裝置截圖結果一致且完美。
                const clone = originalCard.cloneNode(true);
                
                // 設定複製體的樣式
                clone.style.position = 'fixed';
                clone.style.top = '-10000px'; // 移到螢幕外
                clone.style.left = '0';
                clone.style.width = '500px'; // 固定寬度，保證排版
                clone.style.height = 'auto';
                clone.style.zIndex = '-1000';
                // 移除 max-w-sm 限制，改用我們設定的固定寬度
                clone.classList.remove('max-w-sm'); 
                clone.classList.add('w-[500px]');
                
                document.body.appendChild(clone);

                // 等待一下確保 DOM 渲染
                await new Promise(resolve => setTimeout(resolve, 50));

                const canvas = await html2canvas(clone, {
                    scale: 2, // 2x resolution
                    useCORS: true,
                    backgroundColor: null,
                    width: 500, // 告知 html2canvas 寬度
                    windowWidth: 1200 // 模擬桌面環境
                });
                
                // 移除複製體
                document.body.removeChild(clone);

                const imgData = canvas.toDataURL('image/png');
                
                // UI 變更：隱藏原始卡片，顯示圖片
                const img = document.getElementById('final-image');
                img.src = imgData;
                
                originalCard.classList.add('hidden'); // 隱藏 HTML 卡片
                
                const imgArea = document.getElementById('generated-image-area');
                imgArea.classList.remove('hidden');
                imgArea.classList.add('flex');

                btn.classList.add('hidden'); // 隱藏生成按鈕

                // 自動觸發下載 (針對桌面版)
                if (window.innerWidth > 768) {
                    const link = document.createElement('a');
                    link.href = imgData;
                    link.download = '2026-aroma-conference-result.png';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }

            } catch (err) {
                console.error(err);
                alert("圖片生成失敗，請稍後再試");
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        // --- 5. Exhibition Render ---
        const exGrid = document.getElementById('exhibition-grid');
        EXHIBITION_DATA.forEach(item => {
            const html = `
            <div class="group relative overflow-hidden rounded-[2rem] h-[500px] cursor-pointer shadow-xl transition-all duration-500 hover:shadow-2xl hover:-translate-y-2">
                <img src="${item.imageUrl}" alt="${item.title}" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" />
                <div class="absolute inset-0 bg-gradient-to-t ${item.bgGradient} opacity-80 mix-blend-multiply transition-opacity duration-300 group-hover:opacity-90"></div>
                <div class="absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-black/60"></div>
                <div class="absolute inset-0 p-8 flex flex-col justify-between">
                    <div class="flex justify-start">
                        <span class="bg-white/20 backdrop-blur-md px-4 py-1 rounded-full text-xs font-bold text-white tracking-widest uppercase border border-white/10">${item.tag}</span>
                    </div>
                    <div class="transform translate-y-4 transition-transform duration-500 group-hover:translate-y-0">
                        <h3 class="text-4xl font-serif font-bold mb-2 ${item.color} drop-shadow-md">${item.title}</h3>
                        <p class="text-white/80 text-lg mb-8 font-light tracking-wide">${item.subtitle}</p>
                        <button class="flex items-center gap-2 bg-white/20 hover:bg-white/30 backdrop-blur-md border border-white/40 text-white px-6 py-3 rounded-full transition-all duration-300 group-hover:pl-8">
                            進入體驗 <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            </div>`;
            exGrid.insertAdjacentHTML('beforeend', html);
        });

        // Initialize Icons
        lucide.createIcons();
    </script>
</body>
</html>
